<!DOCTYPE html>
<html lang="en">
    <head>
        {% block head %}
            <!-- Required meta tags -->
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

            {% block styles %}
                <!-- Bootstrap CSS -->
                {{ bootstrap.load_css() }}
            {% endblock %}
            <!-- Include Bootstrap CSS -->
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
            <!-- Include Bootstrap-Select CSS -->
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/css/bootstrap-select.min.css">
            <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}?v=20250927">

            {% if title %}
                <title>Alveus Clips - {{ title }}</title>
            {% else %}
                <title>Alveus Clips</title>
            {% endif %}
            <link rel="icon" href="{{ url_for('static', filename='logo.png') }}" type="image/x-icon">
        {% endblock %}
    </head>
    <body>
        {% block navbar %}
        <nav class="navbar navbar-dark navbar-expand-md bg-alveus-green-900 justify-content-start">
            <div class="container-fluid">
                <a href="{{ url_for('main.index') }}" class="navbar-brand d-flex">
                    <img src="{{ url_for('static', filename='logo.png') }}" style="width: 80px;">
                    <span class="align-self-center"><h3>&nbsp;Alveus Clips</h3></span>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsingNavbar">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <ul id="collapsingNavbar" class="navbar-nav mr-auto w-100 justify-content-end">
                    <li class="nav-item active">
                        <a class="nav-link text-white" href="{{ url_for('main.clip_queue') }}">
                            <h5>Clip Queue</h5>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link text-white" href="{{ url_for('main.about') }}">
                            <h5>About</h5>
                        </a>
                    </li>
                    {% if current_user.is_anonymous %}
                        <li class="nav-item active">
                            <a class="nav-link" href="{{ url_for('auth.oauth2_authorize')}}">
                                <h5><i class="fa-solid fa-right-to-bracket text-white" data-toggle="tooltip" title="Sign In"></i></h5>
                            </a>
                        </li>
                    {% else %}
                        {% if current_user.rank.name in ['SUPERADMIN', 'ADMIN', 'MODERATOR'] %}
                            <li class="nav-item active">
                                <a class="nav-link text-white" href="{{ url_for('main.dashboard') }}">
                                    <h5>Dashboard</h5>
                                </a>
                            </li>
                        {% endif %}
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle text-white" href="#" id="accountDropdown" data-bs-toggle="dropdown">
                                <img src="{{ current_user.profile_image_url }}" class="rounded-circle profile-img" alt="Profile Image">
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="btn w-100 text-start" href="{{ url_for('auth.logout') }}">Log Out</a></li>
                            </ul>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </nav>
        {% endblock %}
        {% block content %}
        <div class="section section-dark height-sub-header">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        {% if category != 'form-error' %}
                            <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% endif %}
            {% endwith %}
            
            {# application content needs to be provided in the app_content block #}
            {% block app_content %}{% endblock %}
        </div>
        {% endblock %}

        {% block scripts %}
            <!-- Include jQuery -->
            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
            <!-- Include Bootstrap JS -->
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
            <!-- Include Bootstrap-Select JS -->
            <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/bootstrap-select.min.js"></script>
            <!-- Include Font Awesome JS (for icons) -->
            <script src="https://kit.fontawesome.com/603e4601a6.js" crossorigin="anonymous"></script>
            <!-- Include HTMX -->
            <script src="https://unpkg.com/htmx.org@1.9.11" integrity="sha384-0gxUXCCR8yv9FM2b+U3FDbsKthCI66oH5IA9fHppQq9DDMHuMauqq1ZHBpJxQ0J0" crossorigin="anonymous"></script>
            
            <script>
                $(document).ready(function() {
                    $('.selectpicker').selectpicker({sanitize: false });
                    $('[data-toggle="tooltip"]').tooltip({placement: 'right'});
                });
            </script>
        {% endblock %}
    </body>    
</html>